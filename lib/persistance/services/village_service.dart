import 'package:gbanker/persistance/db_provider.dart';
import 'package:gbanker/persistance/tables/villages_table.dart';
import 'package:gbanker/persistance/entities/Village.dart';
import 'package:sqflite/sqflite.dart';

class VillageService{
  
  static Future<void> seedData() async {
    final Database db = await DbProvider.db.database;
    db.rawInsert("INSERT INTO "+VillagesTable().tableName+" (sub_district_code, union_code,  village_code, village_name) VALUES('38276', '0885', '3827608851', 'Benodpur'),"
    "('38276', '0885', '38276088510', 'Rainagar'),('38276', '0885', '38276088511', 'Kakiladair'),('38276', '0885', '38276088512', 'Boro Laxmipur'),"
        "('38276', '0885', '38276088513', 'Chor lakhepur'),('38276', '0885', '38276088514', 'Gonja prosad pur'),"
        "('38276', '0885', '38276088515', 'Soto nurpur'),('38276', '0885', '38276088516', 'Baneboho'),('38276', '0885', '38276088517', 'Bamnepur'),"
        "('38276', '0885', '38276088518', 'Nourth bobanepur'),('38276', '0885', '38276088519', 'Nurpur'),('38276', '0885', '3827608852', 'Duanche'),"
        "('38276', '0885', '38276088520', 'Azogora'),('38276', '0885', '38276088521', 'Hugladenge'),('38276', '0885', '38276088522', 'Singa'),"
        "('38276', '0885', '38276088523', 'Dulde rogonath pur'),('38276', '0885', '38276088524', 'kamalpur'),('38276', '0885', '38276088525', 'bandareia'),"
        "('38276', '0885', '38276088526', 'Dulde kistopur'),('38276', '0885', '38276088527', 'Vobanepur'),('38276', '0885', '3827608853', 'Borolakhepur'),"
        "('38276', '0885', '3827608854', 'Chak kisto pur'),('38276', '0885', '3827608855', 'South bobanipur'),('38276', '0885', '3827608856', 'Alade pur'),"
        "('38276', '0885', '3827608857', 'Kaji  kanda'),('38276', '0885', '3827608858', 'Betho lia'),('38276', '0885', '3827608859', 'Matipara'),"
        "('38276', '0887', '3827608871', 'baneboho'),('38276', '0887', '3827608872', 'Bartha'),('38276', '0887', '3827608873', 'Rainogor'),"
        "('38276', '0888', '3827608881', 'CHREkOLL'),('38276', '0892', '3827608921', 'Brammandia'),('38276', '0892', '3827608922', 'Kamalpur'),"
        "('38276', '0892', '3827608923', 'Zogotpur'),('38276', '0892', '3827608924', 'Kamaldia kande'),('38276', '1080', '3827610801', 'Chor Khankhanapur'),"
        "('38276', '1080', '3827610802', 'Khankhanapur'),('38276', '1080', '3827610803', 'Decree Char Chadpur'),"
        "('38276', '1080', '3827610804', 'Char Dopakhali'),('38276', '1081', '3827610811', 'Purba Mulghar'),('38276', '1081', '3827610812', 'Pachim Mulghar'),"
        "('38276', '1081', '3827610813', 'Bhagiratpur'),('38276', '1081', '3827610814', 'Rasora'),('38276', '1081', '3827610815', 'Par Sadipur'),"
        "('38276', '1081', '3827610816', 'Par Darponarayanpur'),('38276', '1082', '3827610821', 'Bara Nurpur'),('38276', '1082', '38276108210', 'Madhupur'),"
        "('38276', '1082', '3827610822', 'Gouripur'),('38276', '1082', '3827610823', 'Ruppur'),('38276', '1082', '3827610824', 'Sadipur'),"
        "('38276', '1082', '3827610825', 'Rampur'),('38276', '1082', '3827610826', 'Dhuldi Joypur'),('38276', '1082', '3827610827', 'Ahladipur'),"
        "('38276', '1082', '3827610828', 'Darpa Narayanpur'),('38276', '1082', '3827610829', 'Nimtala'),('38276', '16  ', '38276161', 'MohisheKhola'),"
        "('38276', '3827601', '3827601199', 'Binodpur (Part-1)'),('38276', '3827601', '3827601497', 'Chhota Nurpur (Part-A)'),"
        "('38276', '3827601', '3827601597', 'Dhunchhi (Part-1)'),('38276', '3827601', '3827601796', 'Lakshmikul'),"
        "('38276', '3827601', '3827601850', 'Madhab Lakshmikul'),('38276', '3827601', '3827601995', 'Sonakanda'),"
        "('38276', '3827602', '3827602199', 'Binodpur (Part-2)'),('38276', '3827602', '3827602398', 'Chak Krishnapur (Part-A)'),"
        "('38276', '3827602', '3827602695', 'Kazikanda'),('38276', '3827602', '3827602895', 'Sajjankanda (Part-1)'),"
        "('38276', '3827603', '3827603099', 'Bhabanipur'),('38276', '3827603', '3827603199', 'Binodpur (Part-3)'),"
        "('38276', '3827603', '3827603396', 'Char Maheshpur'),('38276', '3827603', '3827603597', 'Dhunchhi (Part-2)'),"
        "('38276', '3827603', '3827603895', 'Sajjankanda (Part-2)'),('38276', '3827607', '3827607016', 'Aladipur'),('38276', '3827607', '3827607021', 'Alipur'),"
        "('38276', '3827607', '3827607141', 'Barbakpur'),('38276', '3827607', '3827607478', 'Hogaldangi'),('38276', '3827607', '3827607489', 'Indra Narayanpur'),"
        "('38276', '3827607', '3827607538', 'Kalicharanpur'),('38276', '3827607', '3827607549', 'Kalyanpur'),('38276', '3827607', '3827607614', 'Kumar Para'),"
        "('38276', '3827607', '3827607799', 'Panch Thupi'),('38276', '3827607', '3827638276071', 'Kallanpur'),('38276', '3827607', '3827638276074', 'Al ladepur'),"
        "('38276', '3827614', '3827614048', 'Atdapunia'),('38276', '3827614', '3827614092', 'Banibaha'),('38276', '3827614', '3827614097', 'Bara Barigram'),"
        "('38276', '3827614', '3827614146', 'Bartha'),('38276', '3827614', '3827614222', 'Bri-Chatra'),('38276', '3827614', '3827614326', 'Chhota Raghunathpur'),"
        "('38276', '3827614', '3827614386', 'Digdapunia'),('38276', '3827614', '3827614429', 'Ghimora'),('38276', '3827614', '3827614636', 'Lakshmi Narayanpur'),"
        "('38276', '3827614', '3827614679', 'Mahishbathan'),('38276', '3827614', '3827614734', 'Morghar'),('38276', '3827614', '3827614777', 'Nijpara'),"
        "('38276', '3827614', '3827614913', 'Said Panchuria'),('38276', '3827614', '3827614940', 'Sandiara'),('38276', '3827614', '3827614951', 'Shibrampur'),"
        "('38276', '3827621', '3827621168', 'Bhabadia'),('38276', '3827621', '3827621201', 'Bil Jaldanga'),('38276', '3827621', '3827621396', 'Elail'),"
        "('38276', '3827621', '3827621434', 'Gopalbari'),('38276', '3827621', '3827621467', 'Hauli Joypur'),('38276', '3827621', '3827621516', 'Kachranda Barat'),"
        "('38276', '3827621', '3827621565', 'Kashimnagar Delundi'),('38276', '3827621', '3827621657', 'Madhurdia'),"
        "('38276', '3827621', '3827621717', 'Matiagachhi'),('38276', '3827621', '3827621750', 'Nabagram'),('38276', '3827621', '3827621766', 'Nayansuk'),"
        "('38276', '3827621', '3827621788', 'Pakuria'),('38276', '3827621', '3827621826', 'Phursahat'),('38276', '3827621', '3827621842', 'Radhakantapur'),"
        "('38276', '3827621', '3827621902', 'Sabar'),('38276', '3827621', '3827621973', 'Sreekul'),('38276', '3827621', '3827621994', 'Urakanda'),"
        "('38276', '3827629', '3827629070', 'Bajitpur'),('38276', '3827629', '3827629103', 'Bara Bhabanipur'),('38276', '3827629', '3827629135', 'Bara Raghunathpur'),"
        "('38276', '3827629', '3827629152', 'Bejkola'),('38276', '3827629', '3827629369', 'Dhuldi Lakshmipur'),('38276', '3827629', '3827629407', 'Gabla'),"
        "('38276', '3827629', '3827629462', 'Hatjhaupur'),('38276', '3827629', '3827629592', 'Khalisa Sonapur'),('38276', '3827629', '3827629608', 'Kola'),"
        "('38276', '3827629', '3827629674', 'Maharajpur'),('38276', '3827629', '3827629695', 'Majlishpur'),('38276', '3827629', '3827629739', 'Muchidaha'),"
        "('38276', '3827629', '3827629853', 'Rajapur'),('38276', '3827629', '3827629935', 'Shayestapur'),('38276', '3827629', '3827629989', 'Udaypur'),"
        "('38276', '3827629', '3827638276299', 'Majlispur'),('38276', '3827632', '3827632002', 'Afra'),('38276', '3827632', '3827632005', 'Ajugara'),"
        "('38276', '3827632', '3827632030', 'Babupur'),('38276', '3827632', '3827632093', 'Baraijuri'),('38276', '3827632', '3827632118', 'Belgachhi Chandpur'),"
        "('38276', '3827632', '3827632220', 'Chandani'),('38276', '3827632', '3827632306', 'Dakshin Chaubaria'),('38276', '3827632', '3827632329', 'Dauki'),"
        "('38276', '3827632', '3827632405', 'Ghorpalan'),('38276', '3827632', '3827632450', 'Harindhara'),('38276', '3827632', '3827632496', 'Jaukura'),"
        "('38276', '3827632', '3827632508', 'Jokai'),('38276', '3827632', '3827632513', 'Kabilpur'),('38276', '3827632', '3827632700', 'Nandalalpur'),"
        "('38276', '3827632', '3827632929', 'Sukdebpur'),('38276', '3827636', '3827636005', 'Agmarai'),('38276', '3827636', '3827636076', 'Baktarpur'),"
        "('38276', '3827636', '3827636081', 'Bamanipur'),('38276', '3827636', '3827636228', 'Chak Krishnapur (Part)'),"
        "('38276', '3827636', '3827636320', 'Chhota Nurpur'),('38276', '3827636', '3827636364', 'Dhuldi Krishnapur'),"
        "('38276', '3827636', '3827636375', 'Dhuldi Raghunathpur (Part)'),('38276', '3827636', '3827636445', 'Gopinathdia'),"
        "('38276', '3827636', '3827636483', 'Hosnabad'),('38276', '3827636', '3827636505', 'Joyrampur'),('38276', '3827636', '3827636554', 'Kamal Diakandi'),"
        "('38276', '3827636', '3827636560', 'Kamalpur'),('38276', '3827636', '3827636647', 'Madhab Lakshmipur (Part)'),"
        "('38276', '3827636', '3827636668', 'Mohammadpur'),('38276', '3827636', '3827636772', 'Nijatpur'),('38276', '3827636', '3827636793', 'Pakurikanda'),"
        "('38276', '3827636', '3827636864', 'Ramchandrapur'),('38276', '3827636', '3827636890', 'Raghunathpur'),('38276', '3827636', '3827636929', 'Samaspur'),"
        "('38276', '3827636', '3827636962', 'Singa'),('38276', '3827636', '3827636978', 'Sreepur'),('38276', '3827636', '3827638276362', 'Raghunath Pur'),"
        "('38276', '3827636', '3827638276363', 'SomeshPur'),('38276', '3827643', '3827643250', 'Char Dhopakhali'),"
        "('38276', '3827643', '3827643277', 'Char Khankhanapur'),('38276', '3827643', '3827643347', 'Decree Char Chandpur'),"
        "('38276', '3827643', '3827643598', 'Khankhanapur'),('38276', '3827645', '3827645103', 'Basudebpur'),"
        "('38276', '3827645', '3827645121', 'Belgachhi Raghunathpur'),('38276', '3827645', '3827645177', 'Bil Nuruddipur'),"
        "('38276', '3827645', '3827645200', 'Boalmari'),('38276', '3827645', '3827645240', 'Char Hatbaria'),"
        "('38276', '3827645', '3827645270', 'Char Raghunathpur'),('38276', '3827645', '3827645281', 'Char Shibrampur'),"
        "('38276', '3827645', '3827645298', 'Dadpur'),('38276', '3827645', '3827645407', 'Ghughusail'),('38276', '3827645', '3827645410', 'Gobindapur'),"
        "('38276', '3827645', '3827645443', 'Hariharpur'),('38276', '3827645', '3827645458', 'Hatbaria'),('38276', '3827645', '3827645544', 'Kantanagar'),"
        "('38276', '3827645', '3827645574', 'Khanganj'),('38276', '3827645', '3827645582', 'Khurda Dadpur'),('38276', '3827645', '3827645584', 'Khoshbari'),"
        "('38276', '3827645', '3827645848', 'Ranigram'),('38276', '3827645', '3827645888', 'Santoshpur'),('38276', '3827645', '3827645979', 'Uttar Chaubaria'),"
        "('38276', '3827651', '3827638276511', 'Bagmara'),('38276', '3827651', '3827651027', 'Ambaria'),('38276', '3827651', '3827651059', 'Baghmara'),"
        "('38276', '3827651', '3827651065', 'Bahara Katuri'),('38276', '3827651', '3827651108', 'Bara Char Beninagar'),"
        "('38276', '3827651', '3827651119', 'Bara Lakshmipur'),('38276', '3827651', '3827651157', 'Beninagar'),"
        "('38276', '3827651', '3827651233', 'Char Ambaria'),('38276', '3827651', '3827651244', 'Char Bahara Katuri'),"
        "('38276', '3827651', '3827651255', 'Char Dhunchi'),('38276', '3827651', '3827651260', 'Char Gachhiadaha'),"
        "('38276', '3827651', '3827651266', 'Char Jaukuri'),('38276', '3827651', '3827651271', 'Char Jazira'),"
        "('38276', '3827651', '3827651282', 'Char Lakshmikul'),('38276', '3827651', '3827651293', 'Char Narasinhadia'),"
        "('38276', '3827651', '3827651299', 'Char Narayanpur'),('38276', '3827651', '3827651304', 'Char Sonakandar'),"
        "('38276', '3827651', '3827651315', 'Chhota Char Ramchandrapur'),('38276', '3827651', '3827651342', 'Dayalnagar'),"
        "('38276', '3827651', '3827651380', 'Dhunchi (Part)'),('38276', '3827651', '3827651391', 'Durgapur'),('38276', '3827651', '3827651413', 'Gachhiadaha'),"
        "('38276', '3827651', '3827651418', 'Gangaprasadpur'),('38276', '3827651', '3827651451', 'Gopinathpur'),"
        "('38276', '3827651', '3827651511', 'Jot Krishnapur'),('38276', '3827651', '3827651532', 'Kakhila Dair'),"
        "('38276', '3827651', '3827651543', 'Kalinagar'),('38276', '3827651', '3827651663', 'Mahadebpur'),('38276', '3827651', '3827651701', 'Malikanda'),"
        "('38276', '3827651', '3827651712', 'Marjatkul'),('38276', '3827651', '3827651728', 'Maukuri'),('38276', '3827651', '3827651755', 'Naodubi'),"
        "('38276', '3827651', '3827651761', 'Nayandia'),('38276', '3827651', '3827651875', 'Ramkrishnapur'),"
        "('38276', '3827651', '3827651946', 'Sabek Mohadebpur'),('38276', '3827651', '3827651956', 'Silimpur'),"
        "('38276', '3827651', '3827651967', 'Sonakandar (Part)'),('38276', '3827658', '3827658054', 'Baghia'),"
        "('38276', '3827658', '3827658179', 'Bhagirathpur'),('38276', '3827658', '3827658190', 'Bhairabkul'),('38276', '3827658', '3827658206', 'Bil Noabad'),"
        "('38276', '3827658', '3827658402', 'Erenda'),('38276', '3827658', '3827658440', 'Gopalpur'),('38276', '3827658', '3827658810', 'Par Darpa Narayanpur'),"
        "('38276', '3827658', '3827658815', 'Par Sadipur'),('38276', '3827658', '3827658821', 'Paschim Mulghar'),"
        "('38276', '3827658', '3827658831', 'Purba Mulghar'),('38276', '3827658', '3827658891', 'Rasora'),('38276', '3827665', '3827665032', 'Andhar Manik'),"
        "('38276', '3827665', '3827665043', 'Arpara'),('38276', '3827665', '3827665184', 'Bhandaria'),('38276', '3827665', '3827665195', 'Bhudhardia'),"
        "('38276', '3827665', '3827665217', 'Brahmandia'),('38276', '3827665', '3827665337', 'Dayalbanda'),('38276', '3827665', '3827665456', 'Gupta Manik'),"
        "('38276', '3827665', '3827665494', 'Jagatpur'),('38276', '3827665', '3827665570', 'Katajani'),('38276', '3827665', '3827665603', 'Kholabaria'),"
        "('38276', '3827665', '3827665619', 'Konail'),('38276', '3827665', '3827665625', 'Krishnapur'),('38276', '3827665', '3827665685', 'Maishakhola'),"
        "('38276', '3827665', '3827665690', 'Maitkora'),('38276', '3827665', '3827665706', 'Mardanga'),('38276', '3827665', '3827665744', 'Mukundia Haydarpur'),"
        "('38276', '3827665', '3827665804', 'Pangasia'),('38276', '3827680', '3827638276801', 'Raghunathpur'),('38276', '3827680', '3827638276802', 'Ramkantopur'),"
        "('38276', '3827680', '3827638276803', 'Surjonogor'),('38276', '3827680', '3827680038', 'Arabaria'),('38276', '3827680', '3827680114', 'Bara Laharia'),"
        "('38276', '3827680', '3827680125', 'Bara Muraripur'),('38276', '3827680', '3827680163', 'Bethulia'),('38276', '3827680', '3827680239', 'Char Baghmara'),"
        "('38276', '3827680', '3827680288', 'Char Lakshmipur'),('38276', '3827680', '3827680521', 'Kaidanga'),('38276', '3827680', '3827680576', 'Kauria'),"
        "('38276', '3827680', '3827680723', 'Mati Para'),('38276', '3827680', '3827680837', 'Muraripur Radhaganj'),('38276', '3827680', '3827680848', 'Roynagar'),"
        "('38276', '3827680', '3827680859', 'Rajendrapur'),('38276', '3827680', '3827680869', 'Ramkantapur'),('38276', '3827687', '3827687010', 'Ahladipur'),"
        "('38276', '3827687', '3827687130', 'Bara Nurpur'),('38276', '3827687', '3827687331', 'Darpa Narayanpur'),"
        "('38276', '3827687', '3827687358', 'Dhuldi Joypur'),('38276', '3827687', '3827687424', 'Gauripur'),('38276', '3827687', '3827687652', 'Madhupur'),"
        "('38276', '3827687', '3827687782', 'Nimtala'),('38276', '3827687', '3827687886', 'Rampur'),('38276', '3827687', '3827687897', 'Ruppur'),"
        "('38276', '3827687', '3827687907', 'Sadipur'),('38276', '3827694', '3827694086', 'Baniari'),('38276', '3827694', '3827694309', 'Char Shyamnagar'),"
        "('38276', '3827694', '3827694353', 'Dharam Masi'),('38276', '3827694', '3827694473', 'Hazrakhali'),('38276', '3827694', '3827694500', 'Jaldia'),"
        "('38276', '3827694', '3827694527', 'Kaijuri'),('38276', '3827694', '3827694587', 'Khalisa Ramkantapur'),('38276', '3827694', '3827694630', 'Lakshmandia'),"
        "('38276', '3827694', '3827694880', 'Ramnagar'),('38276', '3827694', '3827694918', 'Sailkati'),('38276', '3827694', '3827694935', 'Sastapur'),"
        "('38276', '3827694', '3827694948', 'Sultanpur');");

//    print('Village seed done');
  }

  static Future<void> truncateVillages() async {
    final Database db = await DbProvider.db.database;
    await db.execute("DELETE FROM "+VillagesTable().tableName);
  }

  static Future<int> addVillage(Village village) async {
    final Database db = await DbProvider.db.database;
    int inserted = await db.insert(VillagesTable().tableName, village.toMap(),
        conflictAlgorithm: ConflictAlgorithm.replace);
    return inserted;
  }

  static Future<int> addVillages(List<dynamic> villages) async {
    int i=0;
    final Database db = await DbProvider.db.database;
    Batch batch = db.batch();

    for(dynamic village in villages){
      batch.insert(VillagesTable().tableName,Village(
        subDistrictCode: village['UpozillaCode'].toString(),
        unionCode: village['UnionCode'].toString(),
        villageCode: village['VillageCode'].toString(),
        villageName: village['VillageName']
      ).toMap());
      i++;
    }
    await batch.commit(noResult: true);
    return i;
  }

  static Future<List<Village>> getVillages({String unionId}) async {
    final Database db = await DbProvider.db.database;
    List<Map<String,dynamic>> maps = List<Map<String,dynamic>>();
    if(unionId != null){
      maps = await db.query(VillagesTable().tableName,where:"union_code=?",
      whereArgs: [unionId]);
    }else{
      maps = await db.query(VillagesTable().tableName);
    }


    return List.generate(maps.length, (i){
      return Village(
        id: maps[i]['id'],
        subDistrictCode: maps[i]['sub_district_code'],
        unionCode: maps[i]['union_code'],
        villageCode: maps[i]['village_code'],
        villageName: maps[i]['village_name']
      );
    });

  }
}